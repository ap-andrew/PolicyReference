<p>[toc]</p>
<p>Any server that receives online data is subject to attack. Attacks can be malicious or unintentional.</p>
<p>JSON has a simple programming interface, so JSON-related services and XML-based services are exposed to similar types of threats. For example, transporting JSON data over an unprotected connection can invite a cross-site scripting exposure as JSON data is evaluated by the JavaScript code.</p>
<p>In Apigee, you can configure your API flow with a JSON Threat Protection policy, which can address JSON-related vulnerabilities and minimize attacks on your API.</p>
<p>The JSON Threat Protection policy can detect JSON payload attacks based on configured limits. All the limits are optional.</p>
<p><strong>Note:</strong> If a limit is not specified, the system applies a default value of -1 (the system equates a negative value to no limit).</p>
<h2><a class="jumplink" name="threat_policy"></a>Configuring the JSON Threat Protection policy</h2>

<p>Configure the JSON Threat Protection policy using the following elements.</p>
<table border="1" cellpadding="1" cellspacing="1" class="table" style="width: 690px;">
	<thead>
		<tr>
			<th scope="col" style="text-align: left;">Field Name</th>
			<th scope="col" style="text-align: left;">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Source</td>
			<td>Request that needs to be validated for JSON payload attacks.</td>
		</tr>
		<tr>
			<td>Container depth</td>
			<td>Specifies the maximum allowed nested depth.<br>
				JSON allows you to nest the containers (object and array) in any order to any depth.</td>
		</tr>
		<tr>
			<td>Object entry count</td>
			<td>Specifies the maximum number of entries allowed in an object.</td>
		</tr>
		<tr>
			<td>Object entry name length</td>
			<td>Specifies the maximum string length allowed for an object's entry name.</td>
		</tr>
		<tr>
			<td>Array element count</td>
			<td>Specifies the maximum number of elements allowed in an array.</td>
		</tr>
		<tr>
			<td>String value length</td>
			<td>Specifies the maximum length allowed for a string value.</td>
		</tr>
	</tbody>
</table>
<h2><a class="jumplink" name="schema"></a>Policy schema</h2>
<p>Each policy must conform to a policy schema. All policy constructs, such as elements and attributes mentioned above, are defined in a schema. To download the schema, <a href="/docs/download/file/fid/459">click here</a>.</p>
<h3>Example - JSON Threat Protection policy</h3>
<p>[gist:2929432]</p>
