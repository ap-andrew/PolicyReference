<p>[toc]</p>
<p>The API Platform supports a fault handling model that enables exceptions to be managed using a policy of type RaiseFault.</p>

<p>The RaiseFault policy type works in a similar way as the AssignMessage policy type. A RaiseFault policy generates a new message that is returned to the calling client app as a response. Therefore, the mechanics of RaiseFault are similar to AssignMessage. RaiseFault enables you to generate custom response, along with any required HTTP headers, query parameters, or message content from the source message.</p>

<p>You can configure an API with a RaiseFault policy that executes when an event, defined as an exception, occurs in the message flow. When executed, the RaiseFault policy transfers the message flow execution to the default ErrorFlow, which in turn returns a fault response to the requesting client app.</p>

<h2>Sample RaiseFault policy</h2>

<p>In the most common usage, RaiseFault is used to return a custom response message to the requesting app. For example to return a 404:</p>

<pre>&lt;RaiseFault name=&quot;404&quot;&gt;
 &lt;IgnoreUnresolvedVariables&gt;true&lt;/IgnoreUnresolvedVariables&gt;
 &lt;FaultResponse&gt;
   &lt;Set&gt;
     &lt;StatusCode&gt;404&lt;/StatusCode&gt;
     &lt;ReasonPhrase&gt;Resource not found&lt;/ReasonPhrase&gt;
   &lt;/Set&gt;
 &lt;/FaultResponse&gt;
&lt;/RaiseFault&gt;</pre>

<p>A more complex example involves returning a custom message payload, along with HTTP headers and an HTTP status code, as follows:</p>

	<pre>&lt;RaiseFault name="ExceptionHandler"&gt;
 &lt;IgnoreUnresolvedVariables&gt;true&lt;/IgnoreUnresolvedVariables&gt;
 &lt;FaultResponse&gt;
   &lt;Copy&gt;
      &lt;Headers /&gt;
   &lt;/Copy&gt;
   &lt;Remove&gt;
      &lt;Headers&gt;
         &lt;Header name="h1"/&gt;
      &lt;/Headers&gt;
   &lt;/Remove&gt;
   &lt;Set&gt;
     &lt;Headers&gt;
       &lt;Header name="h1"&gt;hello {user}&lt;/Header&gt;
     &lt;/Headers&gt;
     &lt;Payload contentType="text/xml"&gt;
       &lt;root&gt;this is my payload {variable.v1}&lt;/root&gt;
     &lt;/Payload&gt;
     &lt;StatusCode&gt;{response.status.code}&lt;/StatusCode&gt;
     &lt;ReasonPhrase&gt;Server error&lt;/ReasonPhrase&gt;
   &lt;/Set&gt;
 &lt;FaultResponse&gt;
&lt;RaiseFault&gt;</pre>


<h2><a class="jumplink" name="configure_policy"></a>Configuring a Raise Fault policy</h2>
<p>Configure the RaiseFault policy using the following elements.</p>
<table border="0" cellpadding="1" cellspacing="1" class="table" style="width: 690px;">
	<thead>
		<tr>
			<th style="text-align: left;">Field Name</th>
			<th style="text-align: left;">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>IgnoreUnresolvedVariables: Optional</td>
			<td>
				<div>Ignores any unresolved variable error in the Flow.</div>
				<div>Valid values: true/false</div>
				<div>Default value: true</div>
			</td>
		</tr>
		<tr>
			<td>FaultResponse: Optional</td>
			<td>Defines the response message returned to the requesting client. FaultResponse relies on the same settings as the AssignMessage policy type.</td>
		</tr>
	</tbody>
</table>
<h2><a class="jumplink" name="schema"></a>Policy schema</h2>
<p>Polices conform to a policy schema. All policy constructs such as elements and attributes mentioned above are defined in a schema. To download the schema, <a href="/docs/download/file/fid/192">click here</a>.</p>
<h3>Example - RaiseFault policy</h3>
<p>[gist:4347657]</p>
<h3>RaiseFault flow variables</h3>
<p>Flow variables enable dynamic behavior of policies and Flows at runtime, based on HTTP headers, message content, or Flow context. The following predefined Flow variables are available after a RaiseFault policy executes. For more information about Flow variables, see [node:243].</p>
<table border="1" cellpadding="1" cellspacing="1" class="table" style="width: 690px;">
	<thead>
		<tr>
			<th style="text-align: left;">Variable</th>
			<th style="text-align: left;">Type</th>
			<th style="text-align: left;">Permission</th>
			<th style="text-align: left;">Description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>fault.name</td>
			<td>String</td>
			<td>Read-Only</td>
			<td>Returns the fault name in the error and if not available, an empty string.</td>
		</tr>
		<tr>
			<td>fault.type</td>
			<td>String</td>
			<td>Read-Only</td>
			<td>Returns the fault type in the error and if not available, an empty string.</td>
		</tr>
		<tr>
			<td>fault.category</td>
			<td>String</td>
			<td>Read-Only</td>
			<td>Returns the fault category in the error and if not available, an empty string.</td>
		</tr>
	</tbody>
</table>
